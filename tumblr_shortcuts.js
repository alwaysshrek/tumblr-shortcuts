(function(){var e,i,j,h,k,d,g=function(b,a){return function(){return b.apply(a,arguments)}};e=function(b){return document.getElementById(b)};k=function(b,a){var l;return(l=b.className)!=null?l.match(RegExp("\\b"+a+"\\b","im")):void 0};i=function(){function b(){this._interceptor=g(this._interceptor,this);this._mapping={};this._lookup={enter:13,escape:27};window.addEventListener("keydown",this._interceptor)}b.prototype.add=function(a,b){var c,d,f;if(b==null){f=[];for(d in a)c=a[d],f.push(this._add(d,
c));return f}else return this._add(a,b)};b.prototype._add=function(a,b){var c,d,f,e;e=a.match(/((ctrl|alt|meta|shift)\+)?([a-z0-9]+)(:input)?/i);f=e[2];c=e[3];d=e[4];c=c.length===1?c.toUpperCase().charCodeAt(0):this._lookup[c];f=this._serialize_mod({altKey:f==="alt",ctrlKey:f==="ctrl",shiftKey:f==="shift",metaKey:f==="meta"});this._mapping[c]==null&&(this._mapping[c]={});return this._mapping[c][f]={input:d!=null,event:b}};b.prototype._is_input=function(a){return a instanceof HTMLTextAreaElement||
a instanceof HTMLInputElement};b.prototype._serialize_mod=function(a){return 1*a.altKey+2*a.ctrlKey+4*a.metaKey+8*a.shiftKey};b.prototype._interceptor=function(a){var b,c;if(a==null)a=window.event;c=this._mapping[a.charCode||a.keyCode];b=this._serialize_mod(a);if(c!=null&&c[b]!=null&&this._is_input(a.target)===c[b].input)return c[b].event(a)};return b}();j=function(){function b(){this.changeBlog=g(this.changeBlog,this);this.queuePost=g(this.queuePost,this);this.cancelReblog=g(this.cancelReblog,this);
this.confirmReblog=g(this.confirmReblog,this);this.sendReply=g(this.sendReply,this);this.view=g(this.view,this);this.like=g(this.like,this);this.page=g(this.page,this);this.reblog=g(this.reblog,this)}b.prototype._clickElement=function(a,b){var c;b==null&&(b=!1);if(a!=null)return c=document.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,b,!1,!1,!1,0,null),a.dispatchEvent(c)};b.prototype._changeSelected=function(a,b){var c;if(a!=null)return a.selectedIndex=b,c=document.createEvent("Event"),
c.initEvent("change",!0,!1),a.dispatchEvent(c)};b.prototype._getReblogLink=function(a){var b,c,d,f;b=e(a).getElementsByClassName("post_controls")[0].getElementsByTagName("a");for(c=0,d=b.length;c<d;c++)if(a=b[c],(f=a.href)!=null&&f.match("reblog"))return a};b.prototype.reblog=function(a,b){b==null&&(b=!1);return this._clickElement(this._getReblogLink(a),b)};b.prototype.page=function(a){a=this._getReblogLink(a);a=decodeURIComponent(a.href.match(/redirect_to=.*/)[0].substring(12));return window.location.replace(a)};
b.prototype.like=function(a){a="like_button_"+a.substring(5);return this._clickElement(e(a))};b.prototype.view=function(a){a="permalink_"+a.substring(5);return this._clickElement(e(a),!0)};b.prototype.sendReply=function(a){a="reply_button_"+a.id.substring(12);return this._clickElement(e(a))};b.prototype.confirmReblog=function(){return this._clickElement(e("save_button"))};b.prototype.cancelReblog=function(){return this._clickElement(e("cancel_button"))};b.prototype.queuePost=function(){return this._changeSelected(e("post_state"),
1)};b.prototype.changeBlog=function(){var a;a=e("channel_id");return this._changeSelected(a,a.selectedIndex<a.length-1?a.selectedIndex+1:0)};return b}();h=function(){var b,a,d,c,g;a=document.body.scrollTop+7;d=e("posts").childNodes;for(c=0,g=d.length;c<g;c++)if(b=d[c],k(b,"post")&&a>=b.offsetTop&&a<=b.offsetTop+b.offsetHeight)return b.id};d=new j;j=new i;i=window.location.href.toLowerCase();i.indexOf("/dashboard")!==-1?j.add({l:function(){return d.like(h())},r:function(){return d.reblog(h())},v:function(){return d.view(h())},
p:function(){return d.page(h())},"alt+r":function(){return d.reblog(h(),!0)},"ctrl+enter:input":function(b){return d.sendReply(b.target)}}):i.indexOf("/reblog/")!==-1&&j.add({b:d.changeBlog,"alt+b":function(){d.changeBlog();return d.confirmReblog()},q:d.queuePost,"alt+q":function(){d.queuePost();return d.confirmReblog()},escape:d.cancelReblog,"ctrl+enter":d.confirmReblog})}).call(this);
