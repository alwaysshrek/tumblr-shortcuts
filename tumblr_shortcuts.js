(function(){var g,h,i,j,k,c,e=function(a,b){return function(){return a.apply(b,arguments)}};g=function(a){return document.getElementById(a)};k=function(a,b){var l;return(l=a.className)!=null?l.match(RegExp("\\b"+b+"\\b","im")):void 0};h=function(){function a(){this._interceptor=e(this._interceptor,this);this._mapping={};this._lookup={enter:13,escape:27,up:38,left:37,right:39,down:40};window.addEventListener("keydown",this._interceptor)}a.prototype.add=function(b,a){var d,c,f;if(a==null){f=[];for(c in b)d=
b[c],f.push(this._add(c,d));return f}else return this._add(b,a)};a.prototype._add=function(b,a){var d,c,f;c=b.match(/((ctrl|alt|meta|shift)\+)?([a-z0-9]+)(:input)?/i);f=c[2];d=c[3];c=c[4];d=d.length===1?d.toUpperCase().charCodeAt(0):this._lookup[d];f=this._serialize_mod({altKey:f==="alt",ctrlKey:f==="ctrl",shiftKey:f==="shift",metaKey:f==="meta"});this._mapping[d]==null&&(this._mapping[d]={});return this._mapping[d][f]={input:c!=null,event:a}};a.prototype._is_input=function(b){return b instanceof
HTMLTextAreaElement||b instanceof HTMLInputElement};a.prototype._serialize_mod=function(b){return 1*b.altKey+2*b.ctrlKey+4*b.metaKey+8*b.shiftKey};a.prototype._interceptor=function(b){var a,d;if(b==null)b=window.event;d=this._mapping[b.charCode||b.keyCode];a=this._serialize_mod(b);if(d!=null&&d[a]!=null&&this._is_input(b.target)===d[a].input)return d[a].event(b)};return a}();i=function(){function a(){this.prevPost=e(this.prevPost,this);this.nextPost=e(this.nextPost,this);this.prevPage=e(this.prevPage,
this);this.nextPage=e(this.nextPage,this);this.changeBlog=e(this.changeBlog,this);this.queuePost=e(this.queuePost,this);this.cancelReblog=e(this.cancelReblog,this);this.confirmReblog=e(this.confirmReblog,this);this.sendReply=e(this.sendReply,this);this.view=e(this.view,this);this.page=e(this.page,this);this.reblog=e(this.reblog,this)}a.prototype._clickElement=function(b,a){var d;a==null&&(a=!1);if(b!=null)return d=document.createEvent("MouseEvents"),d.initMouseEvent("click",!0,!0,window,0,0,0,0,0,
a,!1,!1,!1,0,null),b.dispatchEvent(d)};a.prototype._pressKey=function(b){var a;a=document.createEvent("KeyboardEvent");a.initKeyboardEvent("keydown",!0,!0,null,b.charCodeAt(0),!1,!1,!1,0);return document.dispatchEvent(a)};a.prototype._changeSelected=function(b,a){var d;if(b!=null)return b.selectedIndex=a,d=document.createEvent("Event"),d.initEvent("change",!0,!1),b.dispatchEvent(d)};a.prototype._getReblogLink=function(b){var a,d,c,f;a=g(b).getElementsByClassName("post_controls")[0].getElementsByTagName("a");
d=0;for(c=a.length;d<c;d++)if(b=a[d],(f=b.href)!=null&&f.match("reblog"))return b};a.prototype.reblog=function(b,a){a==null&&(a=!1);return this._clickElement(this._getReblogLink(b),a)};a.prototype.page=function(a){a=this._getReblogLink(a);a=decodeURIComponent(a.href.match(/redirect_to=.*/)[0].substring(12));return window.location.replace(a)};a.prototype.view=function(a){a="permalink_"+a.substring(5);return this._clickElement(g(a),!0)};a.prototype.sendReply=function(a){a="reply_button_"+a.id.substring(12);
return this._clickElement(g(a))};a.prototype.confirmReblog=function(){return this._clickElement(g("save_button"))};a.prototype.cancelReblog=function(){return this._clickElement(g("cancel_button"))};a.prototype.queuePost=function(){return this._changeSelected(g("post_state"),1)};a.prototype.changeBlog=function(){var a;a=g("channel_id");return this._changeSelected(a,a.selectedIndex<a.length-1?a.selectedIndex+1:0)};a.prototype.nextPage=function(){return this._clickElement(g("next_page_link"))};a.prototype.prevPage=
function(){return this._clickElement(g("previous_page_link"))};a.prototype.nextPost=function(){return this._pressKey("J")};a.prototype.prevPost=function(){return this._pressKey("K")};return a}();j=function(){var a,b,c,d,e;b=document.body.scrollTop+7;c=g("posts").childNodes;d=0;for(e=c.length;d<e;d++)if(a=c[d],k(a,"post")&&b>=a.offsetTop&&b<=a.offsetTop+a.offsetHeight)return a.id};c=new i;i=new h;h=window.location.href.toLowerCase();h.indexOf("/dashboard")!==-1?i.add({r:function(){return c.reblog(j())},
v:function(){return c.view(j())},p:function(){return c.page(j())},"alt+r":function(){return c.reblog(j(),!0)},"ctrl+enter:input":function(a){return c.sendReply(a.target)},"alt+right":c.nextPage,"alt+left":c.prevPage,"alt+up":c.prevPost,"alt+down":c.nextPost}):h.indexOf("/reblog/")!==-1&&i.add({b:c.changeBlog,"alt+b":function(){c.changeBlog();return c.confirmReblog()},q:c.queuePost,"alt+q":function(){c.queuePost();return c.confirmReblog()},escape:c.cancelReblog,"ctrl+enter":c.confirmReblog})}).call(this);
